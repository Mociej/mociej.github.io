<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
canvas {
    background-color: grey;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <script>
        $(function(){
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");     
            var leftDown = false;
            var rightDown = false;
            var offset = $("#canvas").offset();
            var oX = offset.left;
            var oY = offset.top;
            var width = 800;
            var height = 600;
            var carX = oX + 150;
            var carY = canvas.height - 150;
            var widthCar = 100;
            var widthWheel = 10
            var widthLine = 15;
            var heightLine = 80;
            var line = 0
            var move = 4
            var target = 0
            var action = 15;
            var objX = 0
            var objY = 0
            var widthObject = 100

            var points = 0

            var widthBonus = 30
            
            function Wheel(x, y) {
                ctx.beginPath();
                ctx.fillStyle = "black";
                ctx.arc(x, y, widthWheel, 0, 2 * Math.PI);
                ctx.fill();
                ctx.stroke();
            }

            function Wheels() {
                Wheel(carX, carY + 20)
                Wheel(carX, carY + 80)
                Wheel(carX + widthCar, carY + 20)
                Wheel(carX + widthCar, carY + 80)
            }

            function Road(){
                ctx.clearRect(0, 0, width, height);
                ctx.fillStyle = "grey";
                ctx.rect(oX, oY, width, height);
                ctx.fill();
            }

            function carAction(m) {
                carX += m       
                Wheels()
                ctx.beginPath();
                ctx.fillStyle = "silver";
                ctx.rect(carX, carY, widthCar, widthCar);
                ctx.fill();
                ctx.stroke();
            }

            function Sides(x, y) {
                ctx.beginPath();
                ctx.fillStyle = "white";
                ctx.rect(x, y, widthLine, heightLine / 2);
                ctx.fill();
                ctx.stroke();
                ctx.beginPath();
                ctx.fillStyle = "red";
                ctx.rect(x, y + heightLine / 2, widthLine, heightLine / 2);
                ctx.fill();
                ctx.stroke();
            }
            
            function Center(x, y) {
                ctx.beginPath();
                ctx.fillStyle = "white";
                ctx.rect(x, y, widthLine, heightLine);
                ctx.fill();
                ctx.stroke();
            }

            function Obj() {
                objX = Math.floor(Math.random() * 500) + oX;  
                objY = 0;
                target = 1;
            }

            function ObjDisplay() {
                if (target == 0) {
                    Obj()
                }

                ctx.beginPath();
                ctx.fillStyle = "red";
                ctx.rect(objX, objY, widthObject, widthObject);
                ctx.fill();
                ctx.stroke();

                objY += move
                if (objY >= oY + height) {
                    target = 0
                }
            }
            function LinesDisplay() {
                for (i = line; i < oY + height; i += 150) {
                    Sides(oX + 5, i);
                    Center(oX + (width / 2) - 5, i);
                    Sides(oX + width - 25, i);
                }
            }

            function objectHit() {
                if (carX - widthWheel < objX + widthObject && 
                    carX + widthCar + widthWheel > objX && 
                    carY <= objY + widthObject - move && 
                    carY + widthCar >= objY) {
                    return true
                }

                return false
            }

            function ScoreTable() {
                ctx.beginPath();            
                ctx.fillStyle = "white" 
                ctx.font = "20px Times New Roman";             
                ctx.fillText("Points: " + points , 10, 30);
                ctx.stroke();
            }
            function BonusDisplay() {
                ctx.beginPath();
                ctx.fillStyle = "blue";
                ctx.rect(100, 100, widthBonus, widthBonus);
                ctx.fill();
                ctx.stroke();
            }

            function start() {
                if (line > 150) {
                    line = 0
                }
                line += move

                if (objectHit()) {
                    return
                }

                Road();
                LinesDisplay();
                ObjDisplay();
                BonusDisplay();
                carAction(0);
                ScoreTable();

                if (leftDown) {
                    if (carX > oX)
                        carAction(-action);                     
                } else if (rightDown) {
                    if (carX < (canvas.width - widthCar))
                        carAction(action);                   
                }
                requestAnimationFrame(start);
            }

            document.onkeydown = keyDown;
            document.onkeyup = keyUp;

            function keyDown(e) {
                e = e || window.event;

                if (e.keyCode == '37') 
                        leftDown = true            
                else if (e.keyCode == '39') 
                    rightDown = true                              
            }

            function keyUp(e) {
                if (e.keyCode == '37')
                    leftDown = false;           
                else if (e.keyCode == '39') 
                    rightDown = false;            
            }

            start();
        });

    </script>
    <canvas id="canvas" width=800 height=600></canvas>
</body>
</html>